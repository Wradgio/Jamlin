# JaMLin
**Ja**va **M**arkup **L**anguage **In**ternalization is a simple command line tool that works in 2 modes Extract and Replace. They are used to:

1. **EXTRACT strings from original HTML or XML.** (eg. index.html)
	* using CSS selectors.
	* creating JSON that can be used to add translations.
2. **REPLACE strings with localised ones.**
	* created from JSON with translations.
	* creating new HTML or XML files (eg. index-en.html).

It's like _gettext_ but for markup language files, without need of special functions and with JSON files to store your translation strings.

## What is it good for
For projects that use static HTML or XML that need to be translated. Sometimes you need to keep HTML in project without additional attributes or special tags, but with some internalisation tool.

## How to use it
To run it, you need too things defined:
1. Config file (required)
2. Parameters (optional)

### Config file
Every time you run JaMLin, it's looking for config file, named **jamlin_config.json** which defines all data needed for extraction in this structure:
```json
{
	"sources": {
		"directories": [
			{
				"path": "templates/",
				"extensions": [ "html", "xml" ],
				"traverse": false,
				"selectors": {
					"texts": {
						"type": "text",
						"selector": "p, a"
					},
					"params": {
						"type": "attribute",
						"selector": "a[title], img[title]",
						"attrName": "title"
					}
				}
			}
		],
		"files": [
			{
				"path": "test-*.html",
				"selectors": {
					"texts": {
						"type": "text",
						"selector": "p, a"
					},
					"params": {
						"type": "attribute",
						"selector": "a[title], img[title]",
						"attrName": "title"
					}
				}
			}
		]
	},
	"target": {
		"replace_file": true,
		"replace_pattern": "*-$lang.*"
	}
}
```
It defines sources and targets:
1. In sources, you define what texts you want to use for translation. You can traverse whole directories for file with defined extensions or use only selected files. Within these two tools you define tags, you want to use using [CSS selectors](https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Selectors). You can define your own names for unlimited number of selectors using 3 types - text, attribute and value.
2. In target you define replace pattern of file and if existing file can be replaced (TODO).

You will probably need separate config for every project.

Afte you set it up, you can define parameters - action, source, target and language.

JaMLin by default uses "extract" action to traverse defined items and trying to extract their translations. When run with "replace" action, it tries to get new translations back to its original files.

### Parameters
JaMLin receives 4 parameters. Examples of using Jamlin looks like this:

`java -jar jamlin-jar-with-dependencies.jar
	--action "extract"
	--source "jamlin_demo.html"
	--language "sk"`

`java -jar jamlin-jar-with-dependencies.jar
	--action "replace"
	--source "jamlin_demo-extract.json"
	--target "jamlin_demo.html"
	--language "en"`

Parameters legend:

* **action** (required) - supports 2 values:
	* "extract" (default),
	* "replace".
* **source** - source file to read, differs according to action:
	* for "extract" action it's HTML file,
	* for "replace" action it's JSON file generated by "extract" command.
* **target** - target file is for one action only:
	* for "replace" action it's HTML file whose name will be used to create file names for target HTML files.
* **language** (optional) - language (eg. "en", "en\_US", "zh\_CN_#Hans", ...) works two ways
	* for "extract" action it sets, what language version was used for extract strings,
	* for "replace" action sets what language you want to output.

According to parameters, every action can have 3 modes:

* **extract**
	1. **lang specific mode** - extract one language only. <br/>
	`java -jar jamlin-jar-with-dependencies.jar --action "extract" --source "jamlin_demo.html" --language "sk"`
	2. **semiautomatic mode** - extract and try to get language from source, if not use "xx". <br/>
	`java -jar jamlin-jar-with-dependencies.jar --action "extract" --source "jamlin_demo.html"`
	3. **full automatic mode** - extract all using config (default). Extract action is default. <br/>
	`java -jar jamlin-jar-with-dependencies.jar`
* **replace**
	1. **lang specific mode** - replace one language only. <br/>
	`java -jar jamlin-jar-with-dependencies.jar --action "replace" --source "jamlin_demo-extract.json" --target "jamlin_demo.html" --language "en"`
	2. **semiautomatic mode** - using selected target replace all languages from translation source and create related output files. <br/>
	`java -jar jamlin-jar-with-dependencies.jar --action "replace" --source "jamlin_demo-extract.json" --target "jamlin_demo.html"`
	3. **full automatic mode** - replace all using config (default). <br/>
	`java -jar jamlin-jar-with-dependencies.jar --action "replace"`


## Translation
JaMLin does not translate data by itself. It only extracts strings according to your  To translate it, you need to fill translations into JSON file using this format:
```json
{
  "translationBlocks": [
    {
      "name": "texts",
      "cssSelector": "p, a",
      "type": "text",
      "translationStrings": [
        {
          "stringOrig": "Menu",
          "selector": "#mobile_menu",
          "translations": [
            {
              "langCode": "en",
              "translation": "Menu EN version"
            },
            {
              "langCode": "sk",
              "translation": "Menu SK version"
            }
          ]
        }
      ]
    }
  ]
}
```
For that, you can use any editor, that can read JSON files or wait for **JaMLin Translation Editor** (in development).


## How to use it

In target directory ...

## Why is it such a mess
It's my first tool in Java and Maven, a one man project. It will take a time to clean it up, any help is appreciated.
